<%= form_for @user, :html => { :class => 'form-horizontal' } do |f| %>
  <fieldset>
    <legend><%= controller.action_name.capitalize %> User</legend>
  <% if not @user.errors.empty? %>
    <div class="alert alert-block alert-error">
    <h3>The following fields need to be updated:</h3>
    <a class="close" data-dismiss="alert">Ã—</a>
    <ul>
    <% @user.errors.full_messages.each do |error| %>
      <li><%= error %></li>
    <% end%>
    </ul>
    </div>
  <% end %>

  <div class="control-group">
  <%= f.label :first_name, :class=>"control-label"%>
  <div class="controls">
  <%= f.text_field :first_name %>
  </div>
  </div>
  
  <div class="control-group">
  <%= f.label :last_name, :class=>"control-label"%>
  <div class="controls">
  <%= f.text_field :last_name %>
  </div>
  </div>

  <div class="control-group">
  <%= f.label :email, :class=>"control-label"%>
  <div class="controls">
  <%= f.email_field :email %>
  </div>
  </div>
  
  <div class="control-group">
  <%= f.label :birthday, :class=>"control-label"%>
  <div class="controls">
  <%= date_select('user',:birthday, :prompt => true, :start_year => Date.today.year, :end_year => 1910) %>
  </div>
  </div>

  <div class="control-group">
    <%= f.label :phone, :class => 'control-label' %>
    <div class="controls">
      <%= f.telephone_field :phone, :class => 'text_field' %>
    </div>
  </div>

  <div class="control-group">
    <%= f.label 'Twitter', :class => 'control-label' %>
    <div class="controls">
      <%= f.text_field :twitter_username, :class => 'text_field' %>
    </div>
  </div>

  <div class="control-group">
    <%= f.label 'Facebook', :class => 'control-label' %>
    <div class="controls">
      <%= f.text_field :facebook_url, :class => 'text_field' %>
    </div>
  </div>

  <% if can? :manage, Role %>
  <div class="control-group">
  <%= f.label :roles, :class=>"control-label" %>
  <div class="controls">  
    <% Role.asc(:name).each do |role| %>
      <% if role.name == 'attender'
           next
         end %>
      <%= check_box_tag "user[role_ids][]", role.name, @user.roles.include?(role) %>  
      <%= if role.name != 'cgl' and role.name != 'mtl'
            role.name.humanize 
          else
            role.name.upcase 
          end %>  
  <% end %>
  </div>
  </div>
  <% end %>

    <div class="form-actions">
      <%= f.submit nil, :class => 'btn btn-primary' %>
      <%= link_to 'Cancel', manage_users_path, :class => 'btn' %>
    </div>
  </fieldset>
<% end %>
